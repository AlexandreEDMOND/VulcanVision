### **Évaluation de la Compétition : Résumé des Métriques et Conseils Pratiques**

L’évaluation du modèle dans cette compétition repose sur **trois métriques principales** : **SurfaceDice**, **VOI**, et **TopoScore**. Ces métriques ont été spécifiquement choisies pour évaluer non seulement la précision de la segmentation (comme avec le Dice classique), mais aussi la **topologie** et la **continuité** des couches dans l’espace 3D. C’est crucial dans ce cas, où l’objectif est de "dérouler" des rouleaux en 3D tout en préservant leur structure et en évitant des erreurs topologiques qui pourraient compromettre l’unwrapping virtuel.

### **Les Trois Métriques Utilisées**

1. **SurfaceDice@τ** : **Proximité de la surface**

   * **Objectif** : Mesurer la similitude entre les surfaces de la segmentation prédite et la vérité terrain, avec une tolérance de déplacement de 2 voxels (τ=2.0).
   * **Comment ça marche** : C’est une version améliorée du Dice qui se concentre uniquement sur les **bords de la segmentation**. Elle compare les voxels de la surface prédite à ceux de la vérité terrain, et considère que deux surfaces sont correspondantes si la distance entre elles est inférieure à la tolérance (τ).
   * **Impact** : Cette métrique est particulièrement sensible aux erreurs de **placement des bords**. Par exemple, si ton modèle déplace légèrement la surface d’une feuille mais reste à l'intérieur de la tolérance de 2 voxels, cela sera toléré.

2. **VOI (Variation of Information)** : **Consistance des instances (fission/fusion)**

   * **Objectif** : Vérifier si les instances (les différentes "feuilles" du rouleau) sont bien séparées et fusionnées correctement.
   * **Comment ça marche** : Cette métrique compare les **composantes connectées** dans la prédiction et la vérité terrain en utilisant un calcul d'entropie. Elle distingue les erreurs de **sous-segmentation** (fusion incorrecte de plusieurs instances) et de **sur-segmentation** (division incorrecte d’une seule instance en plusieurs morceaux).
   * **Impact** : Cette métrique est particulièrement sensible aux erreurs où des parties distinctes du rouleau sont fusionnées (erreur de **fusion**) ou une feuille est découpée en plusieurs morceaux (erreur de **scission**). L’objectif est d’éviter ces erreurs pour obtenir une segmentation qui reflète fidèlement les différentes couches du rouleau.

3. **TopoScore** : **Préservation des caractéristiques topologiques**

   * **Objectif** : Évaluer si les **caractéristiques topologiques** de la feuille de papyrus sont correctement préservées. Cela inclut la connectivité des objets dans l’image 3D, et si des ponts artificiels (entre des couches adjacentes), des trous ou des poignées (handle) sont créés par erreur.
   * **Comment ça marche** : Cette métrique se base sur les concepts de la **topologie algébrique**, en analysant les **composantes** (k=0), les **tunnels** (k=1) et les **cavités** (k=2). Le **Betti number** est utilisé pour vérifier si les objets dans la segmentation sont correctement connectés ou s'il y a des erreurs topologiques (comme des trous ou des ponts).
   * **Impact** : Cette métrique pénalise fortement les erreurs topologiques, telles que les **ponts artificiels** qui connectent de manière incorrecte des zones adjacentes du rouleau ou des **trous/cavités** dans la segmentation qui ne devraient pas être là.

### **Formule de la Scoring**

La **note finale** est une combinaison pondérée des trois métriques :
[
\text{Score final} = 0.30 \times \text{TopoScore} + 0.35 \times \text{SurfaceDice@τ} + 0.35 \times \text{VOI_score}
]

* **Toposcore** : 30%
* **SurfaceDice@τ** : 35%
* **VOI_score** : 35%

Cela signifie que la **SurfaceDice@τ** et le **VOI_score** ont plus de poids que le **TopoScore**, mais **toutes les métriques sont importantes** pour obtenir un score optimal.

### **Conseils Pratiques pour Optimiser Ton Modèle**

1. **Favoriser la continuité au sein de chaque couche** : Essaie de minimiser les **fusions incorrectes** entre différentes couches du rouleau. Les **ponts artificiels** entre des couches parallèles (qui ne devraient pas être connectées) entraîneront des pénalités élevées dans **TopoScore** et **VOI_score**.

2. **Vérifier les erreurs de topologie** : Attention aux **trous** (k=2) et aux **poignées** (k=1). Les erreurs topologiques sont pénalisées dans **TopoScore**, donc un modèle qui crée des erreurs de ce type sera désavantagé.

3. **Réduire la sur-segmentation** : Si ton modèle divise une seule feuille en plusieurs morceaux (une erreur de **scission**), cela nuira au **VOI_score**. Assure-toi que les couches adjacentes ne sont pas divisées incorrectement.

4. **Utiliser un seuil de tolérance pour SurfaceDice** : Rappelle-toi que la **SurfaceDice** tolère des erreurs de placement limitées, tant que les surfaces sont suffisamment proches (≤ 2 voxels). Cela te permet d'être moins strict sur les erreurs minimes.

5. **Connexion correcte des instances** : En cas de doute, tu peux essayer de manipuler la connectivité dans ton modèle, mais garde à l’esprit que des erreurs de fusion ou de scission affectent fortement **VOI_score**.

6. **Test sous 26‑connectivité** : Lors de l’évaluation des performances de segmentation, vérifie sous **connectivité 26** (c’est-à-dire en considérant toutes les connexions dans les 3D) pour t'assurer que ton modèle reste cohérent sur les bords.

### **Soumission du Fichier**

* **Format** : Chaque image de test doit être soumise sous forme de **fichier `.tif`** avec la même taille et le même type de données que les masques d’entraînement.
* **Nom du fichier** : Chaque masque doit être nommé selon l’identifiant de l’image (`[image_id].tif`).

### **Résumé des Points Clés**

* **Éviter les erreurs topologiques** : Ce sont les plus pénalisantes (ponts artificiels, cavités).
* **Assurer une bonne séparation des instances** : Attention aux erreurs de fusion et de scission.
* **Optimiser la SurfaceDice** : Le modèle peut tolérer de petites erreurs de positionnement de surface, tant qu’elles sont dans la tolérance de 2 voxels.
* **Compenser la perte d’une métrique par l’amélioration des autres** : Le Score final est un compromis entre les trois métriques.

Si tu veux explorer des idées pour améliorer tes résultats ou commencer à implémenter un modèle de segmentation, n’hésite pas à me demander !
